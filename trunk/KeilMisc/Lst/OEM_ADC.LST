C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 1   


C51 COMPILER V8.12, COMPILATION OF MODULE OEM_ADC
OBJECT MODULE PLACED IN Code\OEM\OEM_ADC.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE Code\OEM\OEM_ADC.C LA WL(1) CD OT(9,SIZE) NOAREGS OR INCDIR(.\Code\CORE\INC
                    -LUDE\;.\Code\OEM\INCLUDE\;.\Code\CHIP\INCLUDE\)

line level    source

   1          /*-----------------------------------------------------------------------------
   2           * TITLE: OEM_ADC.C
   3           *
   4           * Author : Dino
   5           *
   6           * Note : These functions are reference only.
   7           *        Please follow your project software specification to do some modification.
   8           *---------------------------------------------------------------------------*/
   9          
  10          #include <CORE_INCLUDE.H>
  11          #include <OEM_INCLUDE.H>
  12          //----------------------------------------------------------------------------
  13          // The function of scaning ADC channel
  14          //----------------------------------------------------------------------------
  15          void ScanADCFixChannel(void)
  16          {
  17   1              if(IS_MASK_SET(VCH5CTL, BIT7))
  18   1          {
  19   2              VCH5CTL |= 0x80;        // write clear data vaild flag
  20   2                      ADP_I= ((WORD)VCH5DATM << 8) + VCH5DATL;
  21   2          }
  22   1              if(IS_MASK_SET(VCH4CTL, BIT7))
  23   1          {
  24   2              VCH4CTL |= 0x80;        // write clear data vaild flag
  25   2                      Read_VR_CPU_PWROK= ((WORD)VCH4DATM << 8) + VCH4DATL;
  26   2          }
  27   1          if(IS_MASK_SET(VCH6CTL, BIT7))
  28   1              {
  29   2                      BYTE i;                                 
  30   2                      LWORD Psys_SUM = 0;             
  31   2      
  32   2                      VCH6CTL |= 0x80;        // write clear data vaild flag
  33   2                      Psys= ((WORD)VCH6DATM << 8) + VCH6DATL;
  34   2                      
  35   2                      for (i=3; i>0; i--)
  36   2                      {
  37   3                              Psys_Data[i] = Psys_Data[i-1];
  38   3                              Psys_SUM += Psys_Data[i];
  39   3                      }
  40   2                      Psys_Data[0] = Psys;
  41   2                      Psys_SUM += Psys_Data[0];
  42   2              Psys_AvgData = Psys_SUM / 4; //calculate 4 times average value
  43   2              }
  44   1      
  45   1      
  46   1      }
  47          
  48          void ScanADCDyChannel1(void)
  49          {
  50   1              BYTE i;
  51   1              LWORD ADP_I_SUM = 0;
  52   1      
  53   1          if(IS_MASK_SET(VCH0CTL, BIT7))
  54   1          {
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 2   

  55   2              VCH0CTL |= 0x80;        // write clear data vaild flag
  56   2                      NTC_V1= ((WORD)VCH0DATM << 8) + VCH0DATL;
  57   2          }
  58   1          if(IS_MASK_SET(VCH1CTL, BIT7))
  59   1          {
  60   2              VCH1CTL |= 0x80;        // write clear data vaild flag
  61   2                      NTC_V2= ((WORD)VCH1DATM << 8) + VCH1DATL;
  62   2          }
  63   1          
  64   1          if ((SysPowState == SYSTEM_S0)&& Read_AC_IN())//add ACIN condition.
  65   1          {
  66   2                      ADPI2Sec++;
  67   2                      for (i=3; i>0; i--)
  68   2                      {
  69   3                              ADPI_Data[i] = ADPI_Data[i-1];
  70   3                              ADP_I_SUM += ADPI_Data[i];
  71   3                      }
  72   2                      ADPI_Data[0] = ADP_I;
  73   2                      ADP_I_SUM += ADPI_Data[0];
  74   2                      ADPI_AvgData = ADP_I_SUM / 4;
  75   2         
  76   2                      if (!(ADPI2Sec%5))// HEGANGS006£ºModify protect setting
  77   2                      {       
  78   3                              if(Proch_Delay>0) // HEGANGS032:Modify power setting
  79   3                              Proch_Delay--;
  80   3                              if(Proch_Delay>8)
  81   3                              Proch_Delay=8;
  82   3                              if(IS_MASK_CLEAR(SEL_STATE0,PRESENT_A))//AC mode (delay 400ms)
  83   3                              {
  84   4                                      if(ADPI_AvgData >= 423) 
  85   4                                      {
  86   5                                              SET_MASK(Thro_Status2, b7ProCH_Psys);
  87   5                                              SET_MASK(GPU_Prochot, b1_Psys);
  88   5                                              Proch_Delay = 3;
  89   5                                      }
  90   4                                      else if(ADPI_AvgData < 396)
  91   4                                      {
  92   5                                              if(Proch_Delay == 0)
  93   5                                              {
  94   6                                                      CLEAR_MASK(Thro_Status2, b7ProCH_Psys);
  95   6                                                      CLEAR_MASK(GPU_Prochot, b1_Psys);
  96   6                                              }
  97   5                                      }
  98   4                              }
  99   3                              else   //AC+DC
 100   3                              {
 101   4                                      if (nBattGasgauge >= 10)
 102   4                                      {
 103   5                                              if(ADPI_AvgData >= 512) //1.5v
 104   5                                              {
 105   6                                                      SET_MASK(Thro_Status2, b7ProCH_Psys);
 106   6                                                      SET_MASK(GPU_Prochot, b1_Psys);
 107   6                                              }
 108   5                                              else if(ADPI_AvgData < 512)
 109   5                                              {
 110   6                                                      CLEAR_MASK(Thro_Status2, b7ProCH_Psys);
 111   6                                                      CLEAR_MASK(GPU_Prochot, b1_Psys);
 112   6                                              }
 113   5                                      }
 114   4                                      else
 115   4                                      {
 116   5                                              if(ADPI_AvgData >= 409) //1.27   //1.19v = 406 58w  //64w 1.28v//1.24V//1.2v
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 3   

 117   5                                              {
 118   6                                                      SET_MASK(Thro_Status2, b7ProCH_Psys);
 119   6                                                      SET_MASK(GPU_Prochot, b1_Psys);
 120   6                                                      Proch_Delay = 8;
 121   6                                              }
 122   5                                              else if(ADPI_AvgData < 382)//1.1 //1.06 = 362 53w   //59w 1.18v 403//1.12V
 123   5                                              {
 124   6                                                      if(Proch_Delay ==0)
 125   6                                                      {
 126   7                                                      CLEAR_MASK(Thro_Status2, b7ProCH_Psys);
 127   7                                                      CLEAR_MASK(GPU_Prochot, b1_Psys);
 128   7                                                      }
 129   6                                              }
 130   5                                              SET_MASK(GPU_Prochot, b1_Psys);
 131   5                                      }
 132   4                              }
 133   3                      }
 134   2                      
 135   2                      if (ADPI2Sec > 200)
 136   2                      {
 137   3                              if (IS_MASK_SET(SEL_STATE0, PRESENT_A))
 138   3                              {
 139   4                                      Chk_HybridFORBQ24780_STPP(); 
 140   4                              }
 141   3                              else
 142   3                              {
 143   4                                      Chk_AC_STPP();
 144   4                              }
 145   3                              ADPI2Sec=0;
 146   3                      }
 147   2              }
 148   1      }
 149          
 150          //----------------------------------------------------------------------------
 151          // Init ADC module
 152          //----------------------------------------------------------------------------
 153          void Init_ADC(void)
 154          {
 155   1              VCH0CTL=ADCChannel_0;   // NTC_V1
 156   1              VCH1CTL=ADCChannel_1;   // NTC_V2
 157   1              VCH4CTL=0x90;   //CPU_VR_READY
 158   1              VCH5CTL=0x90;   // ADP_I (enable voltage channel for channel 5)
 159   1              VCH6CTL=0x90;   // psys
 160   1      
 161   1      }
 162          
 163          //---------------------------------------------------------------------------
 164          // Init Voltage Compare Function
 165          // Input: 1 Group. choice the init VC channel  0: VC0 1: VC1 2:VC2 3:All VC Channel
 166          //---------------------------------------------------------------------------
 167          void Init_VC(BYTE Group)
 168          {
 169   1              int tGroup = (Group&0x03);
 170   1              if( (VCMP0CTL&0x80) || (VCMP1CTL&0x80) || (VCMP2CTL&0x80) )
 171   1              {
 172   2                      IER18 |= 0x80;
 173   2              }
 174   1      }
 175          
 176          void Chk_HybridFORBQ24780_STPP(void)
 177          {
 178   1              if(Read_AC_IN() && (nBattGasgauge > Chk_Hybrid_STPP_min_BattGasgauge))   //HEGANGS038:Modify the charger 
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 4   

             -IC turbo boost point (RSOC>10% Enable)   
 179   1              {
 180   2                      SET_MASK(CHGIC_WriteCmd0x37L, TurboBoost);
 181   2                      if(IS_MASK_CLEAR(LENOVOPMFW,BATTERY_MAIN_CAL))  
 182   2                      {
 183   3                              cBattFlag0.fbit.cCmdAcOff=0;                    //Resume Charger
 184   3                      }
 185   2              }
 186   1              else
 187   1              {
 188   2                      if(IS_MASK_CLEAR(LENOVOPMFW,BATTERY_MAIN_CAL))   
 189   2                      {
 190   3                              cBattFlag0.fbit.cCmdAcOff=0;    
 191   3                      }
 192   2                      
 193   2                      if(nBattGasgauge <= Chk_Hybrid_STPP_min_BattGasgauge)//G32:change disableTurboBoost capacity from 40 to
             - 36//G82:Change battery capacity from 39 to 40 for disable TurboBoost follow SPEC.
 194   2                      {
 195   3                              CLEAR_MASK(CHGIC_WriteCmd0x37L, TurboBoost);
 196   3                      }
 197   2                      if(Read_AC_IN() && (ACModeSTPPEn!=0) && (nBattGasgauge <= (Chk_Hybrid_STPP_min_BattGasgauge-5)))
 198   2                      {
 199   3                              if (ADPI_AvgData > ACModeSTPPEn)
 200   3                              {
 201   4                                      SET_MASK(BatteryAlarm,HybridSTPP);
 202   4                              }
 203   3                              if (ADPI_AvgData < ACModeSTPPDis)
 204   3                              {
 205   4                                      CLR_MASK(BatteryAlarm,HybridSTPP);
 206   4                              }
 207   3                      }
 208   2                      else
 209   2                      {
 210   3                              CLR_MASK(BatteryAlarm,HybridSTPP);
 211   3                      }
 212   2              }
 213   1      }
 214          
 215          void Chk_AC_STPP(void)
 216          {
 217   1              if (Read_AC_IN())
 218   1              {
 219   2                      if (1)
 220   2                      {
 221   3                              if (ADPI_AvgData > ACModeSTPPEn)
 222   3                              {
 223   4                                      SET_MASK(BatteryAlarm,ACSTPP);
 224   4                              }
 225   3                              if (ADPI_AvgData < ACModeSTPPDis)
 226   3                              {
 227   4                                      CLR_MASK(BatteryAlarm,ACSTPP);
 228   4                              }
 229   3                      }
 230   2              }
 231   1      }
 232          
 233          void SetPowerBatteryparameter(void)
 234          {
 235   1              //for EM9 adapter detection and protection    //0.0029296875
 236   1              if((API_ID > 0x2DE) && (API_ID <= 0x374))  // >2.149  <=2.590   
 237   1              {
 238   2                      AdapterID = AdapterID_170W;
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 5   

 239   2              }
 240   1              else if((API_ID > 0x238) && (API_ID <= 0x2D0))  // 1.663(0x238) 2.109(0x2D0)  1.663x1024/3=0x238  
 241   1              {
 242   2                      AdapterID = AdapterID_135W;
 243   2              }
 244   1              else if((API_ID > 0x190) && (API_ID <= 0x228)) //should change to >1.172(0x190) <=1.618(0x228) for 90W  "
             ->0.693(0xEC) <=1.134(0x183) for 65W ",  //0.0029296875
 245   1              {
 246   2                      AdapterID = AdapterID_90W;
 247   2              }
 248   1              else if ((API_ID > 0xEC) && (API_ID <= 0x183))//0.693<API_ID<1.134
 249   1              {
 250   2                      AdapterID = AdapterID_65W;
 251   2              }
 252   1              else if ((API_ID > 0x50) && (API_ID <= 0xE2))//0.234<API_ID<0.663
 253   1              {
 254   2                      AdapterID = AdapterID_45W;
 255   2              }
 256   1              else if((API_ID > 0x380)||(API_ID <=0x46)) // >2.626 or <0.207
 257   1              {
 258   2                      AdapterID = AdapterID_NON_SUPPORT;
 259   2              }
 260   1      
 261   1      
 262   1              if(AdapterID==AdapterID_65W || AdapterID==AdapterID_90W || AdapterID==AdapterID_135W || AdapterID==Adapte
             -rID_170W)
 263   1          {
 264   2              CLEAR_MASK(SYS_STATUS,b5UnSuitAdpPow);
 265   2                      CLEAR_MASK(SYS_STATUS,b4IllegalAdp);
 266   2              }
 267   1          else if(AdapterID==AdapterID_45W)                                   
 268   1              {
 269   2                  CLEAR_MASK(SYS_STATUS,b5UnSuitAdpPow);
 270   2                      CLEAR_MASK(SYS_STATUS,b4IllegalAdp);
 271   2              }
 272   1              else if(AdapterID==AdapterID_NON_SUPPORT)
 273   1              {
 274   2                      SET_MASK(SYS_STATUS,b4IllegalAdp);
 275   2                      CLEAR_MASK(SYS_STATUS,b5UnSuitAdpPow);
 276   2                
 277   2              if(SystemIsS0) 
 278   2                  {
 279   3             
 280   3                  BATT_LEN_ON();//remove AC_OFF function follow charge IC bq24780.    
 281   3                      }
 282   2              } 
 283   1      }       
 284          
 285          //define another function for SetPowerBatteryparameter().
 286          void SetPowerBatteryparameter2(void)
 287          {
 288   1              CLEAR_MASK(SYS_STATUS,b5UnSuitAdpPow);
 289   1              CLEAR_MASK(SYS_STATUS,b4IllegalAdp);    
 290   1      }
 291          //---------------------------------------------------------------------------
 292          // AdapterIdentification: hook 10ms
 293          // Detect adapter ID then set protection if need
 294          // Read ID via ADC/Typec
 295          //---------------------------------------------------------------------------
 296          void AdapterIdentification(void)
 297          {
 298   1              if(AdapterIDOn_Flag) 
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 6   

 299   1          {
 300   2              if(ADPIDON10MS_NUM>0x00)
 301   2              {
 302   3                      ADPIDON10MS_NUM--; 
 303   3              }
 304   2              else 
 305   2              {
 306   3                       #if SUPPORT_ADCID_ADAPTER
                              SetPowerBatteryparameter(); 
                           #endif 
 309   3                  #if SUPPORT_NOID_ADAPTER
                              SetPowerBatteryparameter2(); 
                          #endif
 312   3                  #if SUPPORT_TYPEC_ADAPTER
                             TypecAdapterDetection();
                          #endif
 315   3                  AdapterIDOn_Flag = 0x00;
 316   3                  ADPIDON10MS_NUM=0xFF; 
 317   3              }    
 318   2          } 
 319   1          else 
 320   1          {
 321   2              if(ADPIDON10MS_NUM>0x01)
 322   2              {
 323   3                  ADPIDON10MS_NUM--; 
 324   3              }
 325   2              else 
 326   2              {   
 327   3                  if(ADPIDON10MS_NUM==0x01)
 328   3                  { 
 329   4                      ADPIDON10MS_NUM--;
 330   4                  }     
 331   3               }
 332   2          }
 333   1         
 334   1      }
 335          
 336          
 337          
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 7   

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION Com005B (BEGIN)
0000         L?0092:
0000 7C00              MOV     R4,#00H
0002 2400              ADD     A,#00H
0004 FF                MOV     R7,A
0005 EC                MOV     A,R4
0006 3E                ADDC    A,R6
0007 F0                MOVX    @DPTR,A
0008 A3                INC     DPTR
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
000B 22                RET     
000C         L?0093:
000C 900000      E     MOV     DPTR,#ACModeSTPPDis
000F E0                MOVX    A,@DPTR
0010 FE                MOV     R6,A
0011 A3                INC     DPTR
0012 C3                CLR     C
0013         L?0094:
0013 E0                MOVX    A,@DPTR
0014 FF                MOV     R7,A
0015 900000      E     MOV     DPTR,#ADPI_AvgData+01H
0018 E0                MOVX    A,@DPTR
0019 9F                SUBB    A,R7
001A 900000      E     MOV     DPTR,#ADPI_AvgData
001D E0                MOVX    A,@DPTR
001E 9E                SUBB    A,R6
001F 22                RET     
0020         L?0095:
0020 F583              MOV     DPH,A
0022         L?0096:
0022 E0                MOVX    A,@DPTR
0023 FE                MOV     R6,A
0024 A3                INC     DPTR
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 E4                CLR     A
0028 FC                MOV     R4,A
0029 FD                MOV     R5,A
002A 020000      E     LJMP    ?C?LADD
002D         L?0097:
002D 7C00              MOV     R4,#00H
002F 2400              ADD     A,#00H
0031 FF                MOV     R7,A
0032 EC                MOV     A,R4
0033 3E                ADDC    A,R6
0034 F0                MOVX    @DPTR,A
0035 A3                INC     DPTR
0036 EF                MOV     A,R7
0037 F0                MOVX    @DPTR,A
0038 22                RET     
0039         L?0098:
0039 900000      E     MOV     DPTR,#Thro_Status2
003C E0                MOVX    A,@DPTR
003D 4480              ORL     A,#080H
003F F0                MOVX    @DPTR,A
0040         L?0099:
0040 900000      E     MOV     DPTR,#GPU_Prochot
0043 E0                MOVX    A,@DPTR
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 8   

0044 4402              ORL     A,#02H
0046 F0                MOVX    @DPTR,A
0047 22                RET     
0048         L?0100:
0048 900000      E     MOV     DPTR,#Chk_Hybrid_STPP_min_BattGasgauge
004B E0                MOVX    A,@DPTR
004C         L?0101:
004C FF                MOV     R7,A
004D 900000      E     MOV     DPTR,#nBattGasgauge
0050 E0                MOVX    A,@DPTR
0051 D3                SETB    C
0052 9F                SUBB    A,R7
0053 22                RET     
0054         L?0102:
0054 900000      E     MOV     DPTR,#Thro_Status2
0057 E0                MOVX    A,@DPTR
0058 547F              ANL     A,#07FH
005A F0                MOVX    @DPTR,A
005B 900000      E     MOV     DPTR,#GPU_Prochot
005E E0                MOVX    A,@DPTR
005F 54FD              ANL     A,#0FDH
0061 F0                MOVX    @DPTR,A
0062 22                RET     
0063         L?0103:
0063 E4                CLR     A
0064 7B04              MOV     R3,#04H
0066 FA                MOV     R2,A
0067 F9                MOV     R1,A
0068 F8                MOV     R0,A
0069 120000      E     LCALL   ?C?LLDXDATA
006C 020000      E     LJMP    ?C?ULDIV
006F         L?0104:
006F         L?0105:
006F 900000      E     MOV     DPTR,#ADPI_AvgData
0072 E0                MOVX    A,@DPTR
0073 9401              SUBB    A,#01H
0075 22                RET     
0076         L?0106:
0076         L?0107:
0076 900000      E     MOV     DPTR,#API_ID
0079 E0                MOVX    A,@DPTR
007A 9402              SUBB    A,#02H
007C 22                RET     
007D         L?0108:
007D         L?0109:
007D 900000      E     MOV     DPTR,#API_ID
0080 E0                MOVX    A,@DPTR
0081 9400              SUBB    A,#00H
0083 22                RET     
0084         L?0110:
0084 900000      E     MOV     DPTR,#SYS_STATUS
0087 E0                MOVX    A,@DPTR
0088 54DF              ANL     A,#0DFH
008A F0                MOVX    @DPTR,A
008B E0                MOVX    A,@DPTR
008C 54EF              ANL     A,#0EFH
008E F0                MOVX    @DPTR,A
008F 22                RET     
0090         L?0111:
0090 F583              MOV     DPH,A
0092 E0                MOVX    A,@DPTR
0093 FC                MOV     R4,A
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 9   

0094 A3                INC     DPTR
0095 E0                MOVX    A,@DPTR
0096 FD                MOV     R5,A
0097 EF                MOV     A,R7
0098 25E0              ADD     A,ACC
009A 22                RET     
             ; FUNCTION Com005B (END)

             ; FUNCTION ScanADCFixChannel (BEGIN)
                                           ; SOURCE LINE # 15
                                           ; SOURCE LINE # 16
                                           ; SOURCE LINE # 17
0000 900000      E     MOV     DPTR,#VCH5CTL
0003 E0                MOVX    A,@DPTR
0004 30E713            JNB     ACC.7,?C0001
                                           ; SOURCE LINE # 18
                                           ; SOURCE LINE # 19
0007 E0                MOVX    A,@DPTR
0008 4480              ORL     A,#080H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 20
000B 900000      E     MOV     DPTR,#VCH5DATM
000E E0                MOVX    A,@DPTR
000F FE                MOV     R6,A
0010 900000      E     MOV     DPTR,#VCH5DATL
0013 E0                MOVX    A,@DPTR
0014 900000      E     MOV     DPTR,#ADP_I
0017 120000      R     LCALL   L?0092
                                           ; SOURCE LINE # 21
001A         ?C0001:
                                           ; SOURCE LINE # 22
001A 900000      E     MOV     DPTR,#VCH4CTL
001D E0                MOVX    A,@DPTR
001E 30E713            JNB     ACC.7,?C0002
                                           ; SOURCE LINE # 23
                                           ; SOURCE LINE # 24
0021 E0                MOVX    A,@DPTR
0022 4480              ORL     A,#080H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 25
0025 900000      E     MOV     DPTR,#VCH4DATM
0028 E0                MOVX    A,@DPTR
0029 FE                MOV     R6,A
002A 900000      E     MOV     DPTR,#VCH4DATL
002D E0                MOVX    A,@DPTR
002E 900000      E     MOV     DPTR,#Read_VR_CPU_PWROK
0031 120000      R     LCALL   L?0092
                                           ; SOURCE LINE # 26
0034         ?C0002:
                                           ; SOURCE LINE # 27
0034 900000      E     MOV     DPTR,#VCH6CTL
0037 E0                MOVX    A,@DPTR
0038 20E703            JB      ACC.7,$ + 6H
003B 020000      R     LJMP    ?C0007
                                           ; SOURCE LINE # 28
                                           ; SOURCE LINE # 30
003E 900000      R     MOV     DPTR,#Psys_SUM
0041 120000      E     LCALL   ?C?LSTKXDATA
0044 00                DB      00H
0045 00                DB      00H
0046 00                DB      00H
0047 00                DB      00H
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 10  

                                           ; SOURCE LINE # 32
0048 900000      E     MOV     DPTR,#VCH6CTL
004B E0                MOVX    A,@DPTR
004C 4480              ORL     A,#080H
004E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 33
004F 900000      E     MOV     DPTR,#VCH6DATM
0052 E0                MOVX    A,@DPTR
0053 FE                MOV     R6,A
0054 900000      E     MOV     DPTR,#VCH6DATL
0057 E0                MOVX    A,@DPTR
0058 900000      E     MOV     DPTR,#Psys
005B 120000      R     LCALL   L?0097
                                           ; SOURCE LINE # 35
005E 900000      R     MOV     DPTR,#i
0061 7403              MOV     A,#03H
0063 F0                MOVX    @DPTR,A
0064         ?C0004:
                                           ; SOURCE LINE # 36
                                           ; SOURCE LINE # 37
0064 900000      R     MOV     DPTR,#i
0067 E0                MOVX    A,@DPTR
0068 FF                MOV     R7,A
0069 25E0              ADD     A,ACC
006B 2400        E     ADD     A,#LOW Psys_Data+0FFFEH
006D F582              MOV     DPL,A
006F E4                CLR     A
0070 3400        E     ADDC    A,#HIGH Psys_Data+0FFFEH
0072 120000      R     LCALL   L?0111
0075 2400        E     ADD     A,#LOW Psys_Data
0077 F582              MOV     DPL,A
0079 E4                CLR     A
007A 3400        E     ADDC    A,#HIGH Psys_Data
007C F583              MOV     DPH,A
007E EC                MOV     A,R4
007F F0                MOVX    @DPTR,A
0080 A3                INC     DPTR
0081 ED                MOV     A,R5
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 38
0083 900000      R     MOV     DPTR,#Psys_SUM
0086 120000      E     LCALL   ?C?LLDXDATA0
0089 900000      R     MOV     DPTR,#i
008C E0                MOVX    A,@DPTR
008D 25E0              ADD     A,ACC
008F 2400        E     ADD     A,#LOW Psys_Data
0091 F582              MOV     DPL,A
0093 E4                CLR     A
0094 3400        E     ADDC    A,#HIGH Psys_Data
0096 120000      R     LCALL   L?0095
0099 900000      R     MOV     DPTR,#Psys_SUM
009C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 39
009F 900000      R     MOV     DPTR,#i
00A2 E0                MOVX    A,@DPTR
00A3 14                DEC     A
00A4 F0                MOVX    @DPTR,A
00A5 E0                MOVX    A,@DPTR
00A6 70BC              JNZ     ?C0004
00A8         ?C0005:
                                           ; SOURCE LINE # 40
00A8 900000      E     MOV     DPTR,#Psys
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 11  

00AB E0                MOVX    A,@DPTR
00AC FF                MOV     R7,A
00AD A3                INC     DPTR
00AE E0                MOVX    A,@DPTR
00AF 900000      E     MOV     DPTR,#Psys_Data
00B2 CF                XCH     A,R7
00B3 F0                MOVX    @DPTR,A
00B4 A3                INC     DPTR
00B5 EF                MOV     A,R7
00B6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 41
00B7 900000      R     MOV     DPTR,#Psys_SUM
00BA 120000      E     LCALL   ?C?LLDXDATA0
00BD 900000      E     MOV     DPTR,#Psys_Data
00C0 120000      R     LCALL   L?0096
00C3 900000      R     MOV     DPTR,#Psys_SUM
00C6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 42
00C9 900000      R     MOV     DPTR,#Psys_SUM
00CC 120000      R     LCALL   L?0103
00CF 900000      E     MOV     DPTR,#Psys_AvgData
00D2 EE                MOV     A,R6
00D3 F0                MOVX    @DPTR,A
00D4 A3                INC     DPTR
00D5 EF                MOV     A,R7
00D6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 43
                                           ; SOURCE LINE # 46
00D7         ?C0007:
00D7 22                RET     
             ; FUNCTION ScanADCFixChannel (END)

             ; FUNCTION ScanADCDyChannel1 (BEGIN)
                                           ; SOURCE LINE # 48
                                           ; SOURCE LINE # 49
                                           ; SOURCE LINE # 51
0000 900000      R     MOV     DPTR,#ADP_I_SUM
0003 120000      E     LCALL   ?C?LSTKXDATA
0006 00                DB      00H
0007 00                DB      00H
0008 00                DB      00H
0009 00                DB      00H
                                           ; SOURCE LINE # 53
000A 900000      E     MOV     DPTR,#VCH0CTL
000D E0                MOVX    A,@DPTR
000E 30E713            JNB     ACC.7,?C0008
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 55
0011 E0                MOVX    A,@DPTR
0012 4480              ORL     A,#080H
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 56
0015 900000      E     MOV     DPTR,#VCH0DATM
0018 E0                MOVX    A,@DPTR
0019 FE                MOV     R6,A
001A 900000      E     MOV     DPTR,#VCH0DATL
001D E0                MOVX    A,@DPTR
001E 900000      E     MOV     DPTR,#NTC_V1
0021 120000      R     LCALL   L?0097
                                           ; SOURCE LINE # 57
0024         ?C0008:
                                           ; SOURCE LINE # 58
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 12  

0024 900000      E     MOV     DPTR,#VCH1CTL
0027 E0                MOVX    A,@DPTR
0028 30E71B            JNB     ACC.7,?C0009
                                           ; SOURCE LINE # 59
                                           ; SOURCE LINE # 60
002B E0                MOVX    A,@DPTR
002C 4480              ORL     A,#080H
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 61
002F 900000      E     MOV     DPTR,#VCH1DATM
0032 E0                MOVX    A,@DPTR
0033 FE                MOV     R6,A
0034 900000      E     MOV     DPTR,#VCH1DATL
0037 E0                MOVX    A,@DPTR
0038 7C00              MOV     R4,#00H
003A 2400              ADD     A,#00H
003C FF                MOV     R7,A
003D EC                MOV     A,R4
003E 3E                ADDC    A,R6
003F 900000      E     MOV     DPTR,#NTC_V2
0042 F0                MOVX    @DPTR,A
0043 A3                INC     DPTR
0044 EF                MOV     A,R7
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 62
0046         ?C0009:
                                           ; SOURCE LINE # 64
0046 900000      E     MOV     DPTR,#SysPowState
0049 E0                MOVX    A,@DPTR
004A 6410              XRL     A,#010H
004C 6003              JZ      $ + 5H
004E 020000      R     LJMP    ?C0035
0051 900000      E     MOV     DPTR,#GPDRB
0054 E0                MOVX    A,@DPTR
0055 20E003            JB      ACC.0,$ + 6H
0058 020000      R     LJMP    ?C0035
                                           ; SOURCE LINE # 65
                                           ; SOURCE LINE # 66
005B 900000      E     MOV     DPTR,#ADPI2Sec
005E E0                MOVX    A,@DPTR
005F 04                INC     A
0060 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 67
0061 900000      R     MOV     DPTR,#i
0064 7403              MOV     A,#03H
0066 F0                MOVX    @DPTR,A
0067         ?C0011:
                                           ; SOURCE LINE # 68
                                           ; SOURCE LINE # 69
0067 900000      R     MOV     DPTR,#i
006A E0                MOVX    A,@DPTR
006B FF                MOV     R7,A
006C 25E0              ADD     A,ACC
006E 2400        E     ADD     A,#LOW ADPI_Data+0FFFEH
0070 F582              MOV     DPL,A
0072 E4                CLR     A
0073 3400        E     ADDC    A,#HIGH ADPI_Data+0FFFEH
0075 120000      R     LCALL   L?0111
0078 2400        E     ADD     A,#LOW ADPI_Data
007A F582              MOV     DPL,A
007C E4                CLR     A
007D 3400        E     ADDC    A,#HIGH ADPI_Data
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 13  

007F F583              MOV     DPH,A
0081 EC                MOV     A,R4
0082 F0                MOVX    @DPTR,A
0083 A3                INC     DPTR
0084 ED                MOV     A,R5
0085 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 70
0086 900000      R     MOV     DPTR,#ADP_I_SUM
0089 120000      E     LCALL   ?C?LLDXDATA0
008C 900000      R     MOV     DPTR,#i
008F E0                MOVX    A,@DPTR
0090 25E0              ADD     A,ACC
0092 2400        E     ADD     A,#LOW ADPI_Data
0094 F582              MOV     DPL,A
0096 E4                CLR     A
0097 3400        E     ADDC    A,#HIGH ADPI_Data
0099 120000      R     LCALL   L?0095
009C 900000      R     MOV     DPTR,#ADP_I_SUM
009F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 71
00A2 900000      R     MOV     DPTR,#i
00A5 E0                MOVX    A,@DPTR
00A6 14                DEC     A
00A7 F0                MOVX    @DPTR,A
00A8 E0                MOVX    A,@DPTR
00A9 70BC              JNZ     ?C0011
00AB         ?C0012:
                                           ; SOURCE LINE # 72
00AB 900000      E     MOV     DPTR,#ADP_I
00AE E0                MOVX    A,@DPTR
00AF FF                MOV     R7,A
00B0 A3                INC     DPTR
00B1 E0                MOVX    A,@DPTR
00B2 900000      E     MOV     DPTR,#ADPI_Data
00B5 CF                XCH     A,R7
00B6 F0                MOVX    @DPTR,A
00B7 A3                INC     DPTR
00B8 EF                MOV     A,R7
00B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 73
00BA 900000      R     MOV     DPTR,#ADP_I_SUM
00BD 120000      E     LCALL   ?C?LLDXDATA0
00C0 900000      E     MOV     DPTR,#ADPI_Data
00C3 120000      R     LCALL   L?0096
00C6 900000      R     MOV     DPTR,#ADP_I_SUM
00C9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 74
00CC 900000      R     MOV     DPTR,#ADP_I_SUM
00CF 120000      R     LCALL   L?0103
00D2 900000      E     MOV     DPTR,#ADPI_AvgData
00D5 EE                MOV     A,R6
00D6 F0                MOVX    @DPTR,A
00D7 A3                INC     DPTR
00D8 EF                MOV     A,R7
00D9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 76
00DA 900000      E     MOV     DPTR,#ADPI2Sec
00DD E0                MOVX    A,@DPTR
00DE 75F005            MOV     B,#05H
00E1 84                DIV     AB
00E2 E5F0              MOV     A,B
00E4 6003              JZ      $ + 5H
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 14  

00E6 020000      R     LJMP    ?C0014
                                           ; SOURCE LINE # 77
                                           ; SOURCE LINE # 78
00E9 900000      E     MOV     DPTR,#Proch_Delay
00EC E0                MOVX    A,@DPTR
00ED D3                SETB    C
00EE 9400              SUBB    A,#00H
00F0 4003              JC      ?C0015
                                           ; SOURCE LINE # 79
00F2 E0                MOVX    A,@DPTR
00F3 14                DEC     A
00F4 F0                MOVX    @DPTR,A
00F5         ?C0015:
                                           ; SOURCE LINE # 80
00F5 900000      E     MOV     DPTR,#Proch_Delay
00F8 E0                MOVX    A,@DPTR
00F9 D3                SETB    C
00FA 9408              SUBB    A,#08H
00FC 4003              JC      ?C0016
                                           ; SOURCE LINE # 81
00FE 7408              MOV     A,#08H
0100 F0                MOVX    @DPTR,A
0101         ?C0016:
                                           ; SOURCE LINE # 82
0101 900000      E     MOV     DPTR,#SEL_STATE0
0104 E0                MOVX    A,@DPTR
0105 20E02C            JB      ACC.0,?C0017
                                           ; SOURCE LINE # 83
                                           ; SOURCE LINE # 84
0108 C3                CLR     C
0109 900000      E     MOV     DPTR,#ADPI_AvgData+01H
010C E0                MOVX    A,@DPTR
010D 94A7              SUBB    A,#0A7H
010F 120000      R     LCALL   L?0104
0112 400C              JC      ?C0018
                                           ; SOURCE LINE # 85
                                           ; SOURCE LINE # 86
                                           ; SOURCE LINE # 87
0114 120000      R     LCALL   L?0098
                                           ; SOURCE LINE # 88
0117 900000      E     MOV     DPTR,#Proch_Delay
011A 7403              MOV     A,#03H
011C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
011D 020000      R     LJMP    ?C0014
0120         ?C0018:
                                           ; SOURCE LINE # 90
0120 C3                CLR     C
0121 900000      E     MOV     DPTR,#ADPI_AvgData+01H
0124 E0                MOVX    A,@DPTR
0125 948C              SUBB    A,#08CH
0127 120000      R     LCALL   L?0104
012A 505F              JNC     ?C0014
                                           ; SOURCE LINE # 91
                                           ; SOURCE LINE # 92
012C 900000      E     MOV     DPTR,#Proch_Delay
012F E0                MOVX    A,@DPTR
0130 7059              JNZ     ?C0014
                                           ; SOURCE LINE # 93
                                           ; SOURCE LINE # 94
                                           ; SOURCE LINE # 95
                                           ; SOURCE LINE # 96
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 15  

                                           ; SOURCE LINE # 97
                                           ; SOURCE LINE # 98
0132 8023              SJMP    ?C0085
0134         ?C0017:
                                           ; SOURCE LINE # 100
                                           ; SOURCE LINE # 101
0134 900000      E     MOV     DPTR,#nBattGasgauge
0137 E0                MOVX    A,@DPTR
0138 C3                CLR     C
0139 940A              SUBB    A,#0AH
013B 401F              JC      ?C0023
                                           ; SOURCE LINE # 102
                                           ; SOURCE LINE # 103
013D 900000      E     MOV     DPTR,#ADPI_AvgData
0140 E0                MOVX    A,@DPTR
0141 9402              SUBB    A,#02H
0143 4009              JC      ?C0024
                                           ; SOURCE LINE # 104
                                           ; SOURCE LINE # 105
0145 900000      E     MOV     DPTR,#Thro_Status2
0148 E0                MOVX    A,@DPTR
0149 4480              ORL     A,#080H
014B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 106
                                           ; SOURCE LINE # 107
014C 803A              SJMP    ?C0086
014E         ?C0024:
                                           ; SOURCE LINE # 108
014E C3                CLR     C
014F 900000      E     MOV     DPTR,#ADPI_AvgData
0152 E0                MOVX    A,@DPTR
0153 9402              SUBB    A,#02H
0155 5034              JNC     ?C0014
                                           ; SOURCE LINE # 109
                                           ; SOURCE LINE # 110
0157         ?C0085:
                                           ; SOURCE LINE # 111
0157 120000      R     LCALL   L?0102
                                           ; SOURCE LINE # 112
                                           ; SOURCE LINE # 113
015A 802F              SJMP    ?C0014
015C         ?C0023:
                                           ; SOURCE LINE # 115
                                           ; SOURCE LINE # 116
015C C3                CLR     C
015D 900000      E     MOV     DPTR,#ADPI_AvgData+01H
0160 E0                MOVX    A,@DPTR
0161 9499              SUBB    A,#099H
0163 120000      R     LCALL   L?0105
0166 400B              JC      ?C0028
                                           ; SOURCE LINE # 117
                                           ; SOURCE LINE # 118
                                           ; SOURCE LINE # 119
0168 120000      R     LCALL   L?0098
                                           ; SOURCE LINE # 120
016B 900000      E     MOV     DPTR,#Proch_Delay
016E 7408              MOV     A,#08H
0170 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 121
0171 8015              SJMP    ?C0029
0173         ?C0028:
                                           ; SOURCE LINE # 122
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 16  

0173 C3                CLR     C
0174 900000      E     MOV     DPTR,#ADPI_AvgData+01H
0177 E0                MOVX    A,@DPTR
0178 947E              SUBB    A,#07EH
017A 120000      R     LCALL   L?0105
017D 5009              JNC     ?C0029
                                           ; SOURCE LINE # 123
                                           ; SOURCE LINE # 124
017F 900000      E     MOV     DPTR,#Proch_Delay
0182 E0                MOVX    A,@DPTR
0183 7003              JNZ     ?C0029
                                           ; SOURCE LINE # 125
                                           ; SOURCE LINE # 126
                                           ; SOURCE LINE # 127
0185 120000      R     LCALL   L?0102
                                           ; SOURCE LINE # 128
                                           ; SOURCE LINE # 129
0188         ?C0029:
                                           ; SOURCE LINE # 130
0188         ?C0086:
0188 120000      R     LCALL   L?0099
                                           ; SOURCE LINE # 131
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 133
018B         ?C0014:
                                           ; SOURCE LINE # 135
018B 900000      E     MOV     DPTR,#ADPI2Sec
018E E0                MOVX    A,@DPTR
018F D3                SETB    C
0190 94C8              SUBB    A,#0C8H
0192 4014              JC      ?C0035
                                           ; SOURCE LINE # 136
                                           ; SOURCE LINE # 137
0194 900000      E     MOV     DPTR,#SEL_STATE0
0197 E0                MOVX    A,@DPTR
0198 30E005            JNB     ACC.0,?C0033
                                           ; SOURCE LINE # 138
                                           ; SOURCE LINE # 139
019B 120000      R     LCALL   Chk_HybridFORBQ24780_STPP
                                           ; SOURCE LINE # 140
019E 8003              SJMP    ?C0034
01A0         ?C0033:
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 143
01A0 120000      R     LCALL   Chk_AC_STPP
                                           ; SOURCE LINE # 144
01A3         ?C0034:
                                           ; SOURCE LINE # 145
01A3 E4                CLR     A
01A4 900000      E     MOV     DPTR,#ADPI2Sec
01A7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 147
                                           ; SOURCE LINE # 148
01A8         ?C0035:
01A8 22                RET     
             ; FUNCTION ScanADCDyChannel1 (END)

             ; FUNCTION Init_ADC (BEGIN)
                                           ; SOURCE LINE # 153
                                           ; SOURCE LINE # 154
                                           ; SOURCE LINE # 155
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 17  

0000 900000      E     MOV     DPTR,#VCH0CTL
0003 7480              MOV     A,#080H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 156
0006 900000      E     MOV     DPTR,#VCH1CTL
0009 04                INC     A
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 157
000B 900000      E     MOV     DPTR,#VCH4CTL
000E 7490              MOV     A,#090H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 158
0011 900000      E     MOV     DPTR,#VCH5CTL
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 159
0015 900000      E     MOV     DPTR,#VCH6CTL
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 161
0019 22                RET     
             ; FUNCTION Init_ADC (END)

             ; FUNCTION _Init_VC (BEGIN)
                                           ; SOURCE LINE # 167
;---- Variable 'Group' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 168
                                           ; SOURCE LINE # 169
0000 EF                MOV     A,R7
0001 5403              ANL     A,#03H
0003 FF                MOV     R7,A
0004 900000      R     MOV     DPTR,#tGroup
0007 E4                CLR     A
0008 F0                MOVX    @DPTR,A
0009 A3                INC     DPTR
000A EF                MOV     A,R7
000B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 170
000C 900000      E     MOV     DPTR,#VCMP0CTL
000F E0                MOVX    A,@DPTR
0010 20E70E            JB      ACC.7,?C0038
0013 900000      E     MOV     DPTR,#VCMP1CTL
0016 E0                MOVX    A,@DPTR
0017 20E707            JB      ACC.7,?C0038
001A 900000      E     MOV     DPTR,#VCMP2CTL
001D E0                MOVX    A,@DPTR
001E 30E707            JNB     ACC.7,?C0039
0021         ?C0038:
                                           ; SOURCE LINE # 171
                                           ; SOURCE LINE # 172
0021 900000      E     MOV     DPTR,#IER18
0024 E0                MOVX    A,@DPTR
0025 4480              ORL     A,#080H
0027 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 173
                                           ; SOURCE LINE # 174
0028         ?C0039:
0028 22                RET     
             ; FUNCTION _Init_VC (END)

             ; FUNCTION Chk_HybridFORBQ24780_STPP (BEGIN)
                                           ; SOURCE LINE # 176
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 178
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 18  

0000 900000      E     MOV     DPTR,#GPDRB
0003 E0                MOVX    A,@DPTR
0004 30E01B            JNB     ACC.0,?C0040
0007 120000      R     LCALL   L?0100
000A 4016              JC      ?C0040
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 180
000C 900000      E     MOV     DPTR,#CHGIC_WriteCmd0x37L
000F E0                MOVX    A,@DPTR
0010 4404              ORL     A,#04H
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 181
0013 900000      E     MOV     DPTR,#LENOVOPMFW
0016 E0                MOVX    A,@DPTR
0017 20E25E            JB      ACC.2,?C0049
                                           ; SOURCE LINE # 182
                                           ; SOURCE LINE # 183
001A 900000      E     MOV     DPTR,#cBattFlag0
001D E0                MOVX    A,@DPTR
001E 547F              ANL     A,#07FH
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
                                           ; SOURCE LINE # 185
0021 22                RET     
0022         ?C0040:
                                           ; SOURCE LINE # 187
                                           ; SOURCE LINE # 188
0022 900000      E     MOV     DPTR,#LENOVOPMFW
0025 E0                MOVX    A,@DPTR
0026 20E207            JB      ACC.2,?C0043
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
0029 900000      E     MOV     DPTR,#cBattFlag0
002C E0                MOVX    A,@DPTR
002D 547F              ANL     A,#07FH
002F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 191
0030         ?C0043:
                                           ; SOURCE LINE # 193
0030 120000      R     LCALL   L?0100
0033 5007              JNC     ?C0044
                                           ; SOURCE LINE # 194
                                           ; SOURCE LINE # 195
0035 900000      E     MOV     DPTR,#CHGIC_WriteCmd0x37L
0038 E0                MOVX    A,@DPTR
0039 54FB              ANL     A,#0FBH
003B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
003C         ?C0044:
                                           ; SOURCE LINE # 197
003C 900000      E     MOV     DPTR,#GPDRB
003F E0                MOVX    A,@DPTR
0040 30E02E            JNB     ACC.0,?C0045
0043 900000      E     MOV     DPTR,#ACModeSTPPEn
0046 E0                MOVX    A,@DPTR
0047 7002              JNZ     ?C0084
0049 A3                INC     DPTR
004A E0                MOVX    A,@DPTR
004B         ?C0084:
004B 6024              JZ      ?C0045
004D 900000      E     MOV     DPTR,#Chk_Hybrid_STPP_min_BattGasgauge
0050 E0                MOVX    A,@DPTR
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 19  

0051 24FB              ADD     A,#0FBH
0053 120000      R     LCALL   L?0101
0056 5019              JNC     ?C0045
                                           ; SOURCE LINE # 198
                                           ; SOURCE LINE # 199
0058 900000      E     MOV     DPTR,#ACModeSTPPEn
005B E0                MOVX    A,@DPTR
005C FE                MOV     R6,A
005D A3                INC     DPTR
005E 120000      R     LCALL   L?0094
0061 4007              JC      ?C0046
                                           ; SOURCE LINE # 200
                                           ; SOURCE LINE # 201
0063 900000      E     MOV     DPTR,#BatteryAlarm
0066 E0                MOVX    A,@DPTR
0067 4410              ORL     A,#010H
0069 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 202
006A         ?C0046:
                                           ; SOURCE LINE # 203
006A 120000      R     LCALL   L?0093
006D 5009              JNC     ?C0049
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
                                           ; SOURCE LINE # 206
                                           ; SOURCE LINE # 207
006F 8000              SJMP    ?C0087
0071         ?C0045:
                                           ; SOURCE LINE # 209
                                           ; SOURCE LINE # 210
0071         ?C0087:
0071 900000      E     MOV     DPTR,#BatteryAlarm
0074 E0                MOVX    A,@DPTR
0075 54EF              ANL     A,#0EFH
0077 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 211
                                           ; SOURCE LINE # 212
                                           ; SOURCE LINE # 213
0078         ?C0049:
0078 22                RET     
             ; FUNCTION Chk_HybridFORBQ24780_STPP (END)

             ; FUNCTION Chk_AC_STPP (BEGIN)
                                           ; SOURCE LINE # 215
                                           ; SOURCE LINE # 216
                                           ; SOURCE LINE # 217
0000 900000      E     MOV     DPTR,#GPDRB
0003 E0                MOVX    A,@DPTR
0004 30E01F            JNB     ACC.0,?C0054
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
                                           ; SOURCE LINE # 220
                                           ; SOURCE LINE # 221
0007 900000      E     MOV     DPTR,#ACModeSTPPEn
000A E0                MOVX    A,@DPTR
000B FE                MOV     R6,A
000C A3                INC     DPTR
000D D3                SETB    C
000E 120000      R     LCALL   L?0094
0011 4007              JC      ?C0052
                                           ; SOURCE LINE # 222
                                           ; SOURCE LINE # 223
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 20  

0013 900000      E     MOV     DPTR,#BatteryAlarm
0016 E0                MOVX    A,@DPTR
0017 4404              ORL     A,#04H
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 224
001A         ?C0052:
                                           ; SOURCE LINE # 225
001A 120000      R     LCALL   L?0093
001D 5007              JNC     ?C0054
                                           ; SOURCE LINE # 226
                                           ; SOURCE LINE # 227
001F 900000      E     MOV     DPTR,#BatteryAlarm
0022 E0                MOVX    A,@DPTR
0023 54FB              ANL     A,#0FBH
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 229
                                           ; SOURCE LINE # 230
                                           ; SOURCE LINE # 231
0026         ?C0054:
0026 22                RET     
             ; FUNCTION Chk_AC_STPP (END)

             ; FUNCTION SetPowerBatteryparameter (BEGIN)
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
                                           ; SOURCE LINE # 236
0000 D3                SETB    C
0001 900000      E     MOV     DPTR,#API_ID+01H
0004 E0                MOVX    A,@DPTR
0005 94DE              SUBB    A,#0DEH
0007 120000      R     LCALL   L?0106
000A 4016              JC      ?C0055
000C D3                SETB    C
000D A3                INC     DPTR
000E E0                MOVX    A,@DPTR
000F 9474              SUBB    A,#074H
0011 900000      E     MOV     DPTR,#API_ID
0014 E0                MOVX    A,@DPTR
0015 9403              SUBB    A,#03H
0017 5009              JNC     ?C0055
                                           ; SOURCE LINE # 237
                                           ; SOURCE LINE # 238
0019 900000      E     MOV     DPTR,#AdapterID
001C 7403              MOV     A,#03H
001E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
001F 020000      R     LJMP    ?C0056
0022         ?C0055:
                                           ; SOURCE LINE # 240
0022 D3                SETB    C
0023 900000      E     MOV     DPTR,#API_ID+01H
0026 E0                MOVX    A,@DPTR
0027 9438              SUBB    A,#038H
0029 120000      R     LCALL   L?0106
002C 4013              JC      ?C0057
002E D3                SETB    C
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 94D0              SUBB    A,#0D0H
0033 120000      R     LCALL   L?0107
0036 5009              JNC     ?C0057
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 21  

                                           ; SOURCE LINE # 241
                                           ; SOURCE LINE # 242
0038 900000      E     MOV     DPTR,#AdapterID
003B 7404              MOV     A,#04H
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 243
003E 020000      R     LJMP    ?C0056
0041         ?C0057:
                                           ; SOURCE LINE # 244
0041 D3                SETB    C
0042 900000      E     MOV     DPTR,#API_ID+01H
0045 E0                MOVX    A,@DPTR
0046 9490              SUBB    A,#090H
0048 900000      E     MOV     DPTR,#API_ID
004B E0                MOVX    A,@DPTR
004C 9401              SUBB    A,#01H
004E 4011              JC      ?C0059
0050 D3                SETB    C
0051 A3                INC     DPTR
0052 E0                MOVX    A,@DPTR
0053 9428              SUBB    A,#028H
0055 120000      R     LCALL   L?0107
0058 5007              JNC     ?C0059
                                           ; SOURCE LINE # 245
                                           ; SOURCE LINE # 246
005A E4                CLR     A
005B 900000      E     MOV     DPTR,#AdapterID
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 247
005F 805D              SJMP    ?C0056
0061         ?C0059:
                                           ; SOURCE LINE # 248
0061 D3                SETB    C
0062 900000      E     MOV     DPTR,#API_ID+01H
0065 E0                MOVX    A,@DPTR
0066 94EC              SUBB    A,#0ECH
0068 120000      R     LCALL   L?0108
006B 4015              JC      ?C0061
006D D3                SETB    C
006E A3                INC     DPTR
006F E0                MOVX    A,@DPTR
0070 9483              SUBB    A,#083H
0072 900000      E     MOV     DPTR,#API_ID
0075 E0                MOVX    A,@DPTR
0076 9401              SUBB    A,#01H
0078 5008              JNC     ?C0061
                                           ; SOURCE LINE # 249
                                           ; SOURCE LINE # 250
007A 900000      E     MOV     DPTR,#AdapterID
007D 7402              MOV     A,#02H
007F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 251
0080 803C              SJMP    ?C0056
0082         ?C0061:
                                           ; SOURCE LINE # 252
0082 D3                SETB    C
0083 900000      E     MOV     DPTR,#API_ID+01H
0086 E0                MOVX    A,@DPTR
0087 9450              SUBB    A,#050H
0089 120000      R     LCALL   L?0108
008C 4012              JC      ?C0063
008E D3                SETB    C
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 22  

008F A3                INC     DPTR
0090 E0                MOVX    A,@DPTR
0091 94E2              SUBB    A,#0E2H
0093 120000      R     LCALL   L?0109
0096 5008              JNC     ?C0063
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 254
0098 900000      E     MOV     DPTR,#AdapterID
009B 7405              MOV     A,#05H
009D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 255
009E 801E              SJMP    ?C0056
00A0         ?C0063:
                                           ; SOURCE LINE # 256
00A0 D3                SETB    C
00A1 900000      E     MOV     DPTR,#API_ID+01H
00A4 E0                MOVX    A,@DPTR
00A5 9480              SUBB    A,#080H
00A7 900000      E     MOV     DPTR,#API_ID
00AA E0                MOVX    A,@DPTR
00AB 9403              SUBB    A,#03H
00AD 5009              JNC     ?C0066
00AF A3                INC     DPTR
00B0 E0                MOVX    A,@DPTR
00B1 9446              SUBB    A,#046H
00B3 120000      R     LCALL   L?0109
00B6 5006              JNC     ?C0056
00B8         ?C0066:
                                           ; SOURCE LINE # 257
                                           ; SOURCE LINE # 258
00B8 900000      E     MOV     DPTR,#AdapterID
00BB 74FF              MOV     A,#0FFH
00BD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 259
00BE         ?C0056:
                                           ; SOURCE LINE # 262
00BE 900000      E     MOV     DPTR,#AdapterID
00C1 E0                MOVX    A,@DPTR
00C2 6402              XRL     A,#02H
00C4 6015              JZ      ?C0088
00C6 E0                MOVX    A,@DPTR
00C7 6012              JZ      ?C0088
00C9 E0                MOVX    A,@DPTR
00CA 6404              XRL     A,#04H
00CC 600D              JZ      ?C0088
00CE E0                MOVX    A,@DPTR
00CF B40302            CJNE    A,#03H,?C0067
00D2         ?C0068:
                                           ; SOURCE LINE # 263
                                           ; SOURCE LINE # 264
                                           ; SOURCE LINE # 265
                                           ; SOURCE LINE # 266
00D2 8007              SJMP    ?C0088
00D4         ?C0067:
                                           ; SOURCE LINE # 267
00D4 900000      E     MOV     DPTR,#AdapterID
00D7 E0                MOVX    A,@DPTR
00D8 B40504            CJNE    A,#05H,?C0070
                                           ; SOURCE LINE # 268
                                           ; SOURCE LINE # 269
00DB         ?C0088:
                                           ; SOURCE LINE # 270
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 23  

00DB 120000      R     LCALL   L?0110
                                           ; SOURCE LINE # 271
00DE 22                RET     
00DF         ?C0070:
                                           ; SOURCE LINE # 272
00DF 900000      E     MOV     DPTR,#AdapterID
00E2 E0                MOVX    A,@DPTR
00E3 B4FF15            CJNE    A,#0FFH,?C0074
                                           ; SOURCE LINE # 273
                                           ; SOURCE LINE # 274
00E6 900000      E     MOV     DPTR,#SYS_STATUS
00E9 E0                MOVX    A,@DPTR
00EA 4410              ORL     A,#010H
00EC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 275
00ED E0                MOVX    A,@DPTR
00EE 54DF              ANL     A,#0DFH
00F0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 277
00F1 900000      E     MOV     DPTR,#SysPowState
00F4 E0                MOVX    A,@DPTR
00F5 B41003            CJNE    A,#010H,?C0074
                                           ; SOURCE LINE # 278
                                           ; SOURCE LINE # 280
00F8 120000      E     LCALL   BATT_LEN_ON
                                           ; SOURCE LINE # 281
                                           ; SOURCE LINE # 282
                                           ; SOURCE LINE # 283
00FB         ?C0074:
00FB 22                RET     
             ; FUNCTION SetPowerBatteryparameter (END)

             ; FUNCTION SetPowerBatteryparameter2 (BEGIN)
                                           ; SOURCE LINE # 286
                                           ; SOURCE LINE # 287
                                           ; SOURCE LINE # 288
                                           ; SOURCE LINE # 289
0000 120000      R     LCALL   L?0110
                                           ; SOURCE LINE # 290
0003 22                RET     
             ; FUNCTION SetPowerBatteryparameter2 (END)

             ; FUNCTION AdapterIdentification (BEGIN)
                                           ; SOURCE LINE # 296
                                           ; SOURCE LINE # 297
                                           ; SOURCE LINE # 298
0000 900000      E     MOV     DPTR,#AdapterIDOn_Flag
0003 E0                MOVX    A,@DPTR
0004 6017              JZ      ?C0076
                                           ; SOURCE LINE # 299
                                           ; SOURCE LINE # 300
0006 900000      E     MOV     DPTR,#ADPIDON10MS_NUM
0009 E0                MOVX    A,@DPTR
000A D3                SETB    C
000B 9400              SUBB    A,#00H
000D 4002              JC      ?C0077
                                           ; SOURCE LINE # 301
                                           ; SOURCE LINE # 302
                                           ; SOURCE LINE # 303
000F 801E              SJMP    ?C0090
0011         ?C0077:
                                           ; SOURCE LINE # 305
C51 COMPILER V8.12   OEM_ADC                                                               09/14/2018 11:08:16 PAGE 24  

                                           ; SOURCE LINE # 315
0011 E4                CLR     A
0012 900000      E     MOV     DPTR,#AdapterIDOn_Flag
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 316
0016 900000      E     MOV     DPTR,#ADPIDON10MS_NUM
0019 74FF              MOV     A,#0FFH
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
                                           ; SOURCE LINE # 318
001C 22                RET     
001D         ?C0076:
                                           ; SOURCE LINE # 320
                                           ; SOURCE LINE # 321
001D 900000      E     MOV     DPTR,#ADPIDON10MS_NUM
0020 E0                MOVX    A,@DPTR
0021 D3                SETB    C
0022 9401              SUBB    A,#01H
0024 4002              JC      ?C0080
                                           ; SOURCE LINE # 322
                                           ; SOURCE LINE # 323
0026         ?C0089:
                                           ; SOURCE LINE # 324
0026 8007              SJMP    ?C0090
0028         ?C0080:
                                           ; SOURCE LINE # 326
                                           ; SOURCE LINE # 327
0028 900000      E     MOV     DPTR,#ADPIDON10MS_NUM
002B E0                MOVX    A,@DPTR
002C B40103            CJNE    A,#01H,?C0083
                                           ; SOURCE LINE # 328
                                           ; SOURCE LINE # 329
002F         ?C0090:
002F E0                MOVX    A,@DPTR
0030 14                DEC     A
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
                                           ; SOURCE LINE # 331
                                           ; SOURCE LINE # 332
                                           ; SOURCE LINE # 334
0032         ?C0083:
0032 22                RET     
             ; FUNCTION AdapterIdentification (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1330    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----      12
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
